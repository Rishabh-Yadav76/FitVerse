<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Diet Plans | FIT-verse</title>
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --light-color: #ecf0f1;
      --dark-color: #2c3e50;
      --female-accent: #e84393;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background-color: #f5f5f5;
      color: var(--dark-color);
    }
    
    /* Navbar - Same as userprofile */
    header {
      background: linear-gradient(135deg, #264653 ,#2a9d8f );
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      padding: 1rem 2rem;
    }
    
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .logo {
      font-size: 1.8rem;
      font-weight: bold;
      color: white;
    }
    .logo span {
    color: #e9c46a;
}
.nav-links {
    display: flex;
    list-style: none;
}

.nav-links li {
    margin-left: 2rem;
    position: relative;
}

.nav-links a {
    color: white;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s ease;
    padding: 0.5rem 0;
    position: relative;
}

.nav-links a.active, .nav-links a:hover {
    color: #e9c46a;
}

.nav-links a::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background-color: #e9c46a;
    transition: width 0.3s ease;
}

.nav-links a.active::after, .nav-links a:hover::after {
    width: 100%;
}
.user-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--secondary-color);
  }
  .dropdown.user-profile {
    position: relative;
  }
  
/* Existing navbar styles... */

/* ====== Unified Dropdown System ====== */
.dropdown {
    position: relative;
  }
  
  /* Main dropdown menu styles (for both Services and User Profile) */
  .dropdown-menu {
    position: absolute;
    top: 100%;
    background: white;
    min-width: 200px;
    border-radius: 5px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
    z-index: 1000;
    padding: 0;
    margin: 0;
    list-style: none;
  }
  
  /* Services dropdown positions left */
  .dropdown:not(.user-profile) .dropdown-menu {
    left: 0;
  }
  
  /* User profile dropdown positions right */
  .user-profile .dropdown-menu {
    right: 0;
  }
  
  .dropdown:hover .dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }
  
  /* Dropdown menu items */
  .dropdown-menu li {
    margin: 0;
    padding: 0.7rem 1rem;
    border-bottom: 1px solid #eee;
    position: relative;
  }
  
  .dropdown-menu li:last-child {
    border-bottom: none;
  }
  
  .dropdown-menu a {
    color: var(--dark-color);
    text-decoration: none;
    display: block;
  }
  
  .dropdown-menu a:hover {
    color: var(--primary-color);
  }
  
  /* ====== Settings Submenu ====== */
  .settings-option {
    position: relative;
  }
  
  .settings-submenu {
    position: absolute;
    top: 0;
    left: 100%;
    background: white;
    min-width: 180px;
    border-radius: 0 5px 5px 5px;
    box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.1);
    opacity: 0;
    visibility: hidden;
    transform: translateX(-10px);
    transition: all 0.3s ease;
    z-index: 1001;
    padding: 0;
    margin: 0;
    list-style: none;
  }
  
  .settings-option:hover .settings-submenu {
    opacity: 1;
    visibility: visible;
    transform: translateX(0);
  }
  
  /* Adjust submenu position for user profile dropdown */
  .user-profile .settings-submenu {
    left: auto;
    right: 100%;
    transform: translateX(10px);
    border-radius: 5px 0 5px 5px;
  }
  
  .user-profile .settings-option:hover .settings-submenu {
    transform: translateX(0);
  }
  
  /* ====== Mobile Toggle ====== */
  .menu-toggle {
    display: none;
    font-size: 1.5rem;
    cursor: pointer;
  }
    
    
    /* Main Content */
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 2rem;
    }
    
    .page-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .page-header h1 {
      font-size: 2.5rem;
      color: var(--primary-color);
      margin-bottom: 1rem;
    }
    
    .page-header p {
      color: #666;
      font-size: 1.1rem;
      max-width: 700px;
      margin: 0 auto;
    }
    
    /* Diet Plan Sections */
    .section {
      background-color: white;
      border-radius: 10px;
      padding: 2rem;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      margin-bottom: 2rem;
    }
    
    .section-title {
      font-size: 1.8rem;
      color: var(--primary-color);
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
    }
    
    .section-title i {
      margin-right: 1rem;
    }
    
    /* Goal Selection */
    .goal-options {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .goal-card {
      flex: 1;
      padding: 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
      border: 2px solid #eee;
    }
    
    .goal-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .goal-card.active {
      border-color: var(--secondary-color);
      background-color: rgba(52, 152, 219, 0.1);
    }
    
    .goal-card h3 {
      margin-bottom: 0.5rem;
    }
    
    .goal-card p {
      color: #666;
    }
    
    /* Calculator Form */
    .calculator-form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .form-group input, 
    .form-group select {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
    }
    
    .form-group input:focus, 
    .form-group select:focus {
      outline: none;
      border-color: var(--secondary-color);
    }
    
    .btn {
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 1rem;
    }
    
    .btn-primary {
      background-color: var(--secondary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #2980b9;
    }
    
    /* Results Section */
    .results {
      display: none;
      margin-top: 2rem;
      padding: 1.5rem;
      border-radius: 8px;
      background-color: rgba(46, 204, 113, 0.1);
      border-left: 4px solid #2ecc71;
    }
    
    .results h3 {
      margin-bottom: 1rem;
      color: var(--primary-color);
    }
    
    .macros {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .macro-card {
      padding: 1rem;
      border-radius: 8px;
      background-color: white;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      text-align: center;
    }
    
    .macro-card h4 {
      color: #666;
      margin-bottom: 0.5rem;
    }
    
    .macro-card p {
      font-size: 1.5rem;
      font-weight: bold;
    }
    
    /* Meal Plan */
    .meal-plan {
      margin-top: 2rem;
    }
    
    .meal-card {
      margin-bottom: 1.5rem;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }
    
    .meal-header {
      background-color: var(--secondary-color);
      color: white;
      padding: 1rem;
      font-weight: bold;
    }
    
    .meal-content {
      background-color: white;
      padding: 1rem;
    }
    
    .food-item {
      display: flex;
      justify-content: space-between;
      padding: 0.5rem 0;
      border-bottom: 1px solid #eee;
    }
    
    .food-item:last-child {
      border-bottom: none;
    }
    
    /* Budget Filter */
    .budget-filter {
      margin-top: 1rem;
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .budget-options {
      display: flex;
      gap: 0.5rem;
    }
    
    .budget-btn {
      padding: 0.5rem 1rem;
      border: 1px solid #ddd;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .budget-btn.active {
      background-color: var(--secondary-color);
      color: white;
      border-color: var(--secondary-color);
    }
    
    /* Price Indicator */
    .price-indicator {
      font-size: 0.8rem;
      color: #666;
      margin-left: 0.5rem;
    }
    
    .price-low {
      color: #2ecc71;
    }
    
    .price-medium {
      color: #f39c12;
    }
    
    .price-high {
      color: #e74c3c;
    }
    
    /* Women's Health Section */
    .womens-health {
      border-left: 4px solid var(--female-accent);
      background-color: rgba(232, 67, 147, 0.1);
    }
    
    .cycle-phase {
      margin-bottom: 1.5rem;
    }
    
    .phase-title {
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: var(--female-accent);
    }
    
    .nutrient-tips {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-top: 1.5rem;
    }
    
    .nutrient-tip {
      background-color: white;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    }
    
    .nutrient-tip h4 {
      color: var(--female-accent);
      margin-bottom: 0.5rem;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .calculator-form {
        grid-template-columns: 1fr;
      }
      
      .goal-options {
        flex-direction: column;
      }
      
      .macros, .nutrient-tips {
        grid-template-columns: 1fr;
      }
      
      .nav-links {
        display: none;
      }
      
      .menu-toggle {
        display: block;
      }
      
      .budget-filter {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <header>
    <nav class="navbar">
      <div class="logo">FIT<span>-verse</span></div>

      <ul class="nav-links">
        <li><a href="/frontend/index.html" class="nav-item">Home</a></li>
        <li><a href="#" class="nav-item">About</a></li>
        <li class="dropdown">
          <a href="#" class="active">Services ⬇</a>
          <ul class="dropdown-menu">
            <li><a href="personaltraining.html">Personal Training</a></li>
            <li><a href="membership-plans.html">Membership Plans</a></li>
            <li><a href="diet-plans.html" class="active">Diet Plans</a></li>
          </ul>
        </li>
        <li><a href="#" class="nav-item">Contact</a></li>
        <!-- 👤 Shown only when user is logged in -->
        <li class="dropdown user-profile" id="user-profile-nav" style="display: none;">
          <a href="/frontend/public/userprofile.html" class="nav-item">
              <img id="profile-icon-img" src="/uploads/profile-pics/default.png" alt="User" class="user-icon" />
          </a>
          <ul class="dropdown-menu">
              <li><a href="edit-profile.html">Edit Profile</a></li>
              <li class="settings-option">
                  <a href="#">Settings</a>
                  <ul class="settings-submenu">
                      <li><a href="#">Account Settings</a></li>
                      <li><a href="#">Privacy</a></li>
                      <li><a href="#">Notifications</a></li>
                      <li><a href="#">Theme</a></li>
                  </ul>
              </li>
              <li><a href="#" onclick="logout()">Logout</a></li>
          </ul>
      </li>
      
      <!-- 🔐 Shown only when user is logged out -->
      <li class="nav-item" id="login-signup-nav" style="display: none;">
          <a href="/frontend/public/login.html">Login / Signup</a>
      </li>
  </ul>
  <div class="menu-toggle">&#9776;</div>
    </nav>
  </header>

  <!-- Main Content -->
  <div class="container">
    <div class="page-header">
      <h1>Personalized Diet Plan</h1>
      <p>Get customized nutrition recommendations based on your fitness goals, body metrics, and lifestyle. Our AI-powered system creates the perfect plan for your needs.</p>
    </div>

    <!-- Goal Selection Section -->
    <div class="section">
      <div class="section-title">
        <i>🏆</i> Select Your Goal
      </div>
      <div class="goal-options">
        <div class="goal-card active" data-goal="weight-loss">
          <h3>Weight Loss</h3>
          <p>Reduce body fat while maintaining muscle</p>
        </div>
        <div class="goal-card" data-goal="muscle-gain">
          <h3>Muscle Gain</h3>
          <p>Build lean muscle mass effectively</p>
        </div>
        <div class="goal-card" data-goal="maintenance">
          <h3>Maintenance</h3>
          <p>Maintain current weight and composition</p>
        </div>
      </div>
    </div>

    <!-- Calculator Section -->
    <div class="section">
      <div class="section-title">
        <i>🧮</i> Nutrition Calculator
      </div>
      <form id="diet-calculator" class="calculator-form">
        <div>
          <div class="form-group">
            <label for="gender">Gender</label>
            <select id="gender" required>
              <option value="">Select</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
            </select>
          </div>
          <div class="form-group">
            <label for="age">Age (years)</label>
            <input type="number" id="age" min="15" max="100" required>
          </div>
          <div class="form-group">
            <label for="height">Height (cm)</label>
            <input type="number" id="height" min="120" max="250" required>
          </div>
        </div>
        <div>
          <div class="form-group">
            <label for="weight">Weight (kg)</label>
            <input type="number" id="weight" min="30" max="200" required>
          </div>
          <div class="form-group">
            <label for="activity">Activity Level</label>
            <select id="activity" required>
              <option value="">Select</option>
              <option value="1.2">Sedentary (little or no exercise)</option>
              <option value="1.375">Lightly active (light exercise 1-3 days/week)</option>
              <option value="1.55">Moderately active (moderate exercise 3-5 days/week)</option>
              <option value="1.725">Very active (hard exercise 6-7 days/week)</option>
              <option value="1.9">Extremely active (very hard exercise & physical job)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="goal">Goal Intensity</label>
            <select id="goal-intensity">
              <option value="0.8">Slow (0.25kg/week)</option>
              <option value="0.75" selected>Moderate (0.5kg/week)</option>
              <option value="0.7">Aggressive (0.75kg/week)</option>
            </select>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Calculate My Plan</button>
      </form>

      <!-- Results Section -->
      <div id="results" class="results">
        <h3>Your Personalized Nutrition Plan</h3>
        <div class="macros">
          <div class="macro-card">
            <h4>Daily Calories</h4>
            <p id="calories">2000</p>
          </div>
          <div class="macro-card">
            <h4>Protein (g)</h4>
            <p id="protein">150</p>
          </div>
          <div class="macro-card">
            <h4>Carbs (g)</h4>
            <p id="carbs">250</p>
          </div>
          <div class="macro-card">
            <h4>Fats (g)</h4>
            <p id="fats">65</p>
          </div>
        </div>
        
        <h4>BMI: <span id="bmi">22.5</span> (<span id="bmi-category">Normal weight</span>)</h4>
        
        <!-- Budget Filter -->
        <div class="budget-filter">
          <span>Meal Budget:</span>
          <div class="budget-options">
            <button class="budget-btn active" data-budget="low">Low</button>
            <button class="budget-btn" data-budget="medium">Medium</button>
            <button class="budget-btn" data-budget="high">High</button>
          </div>
        </div>
        
        <div class="meal-plan">
          <h4>Sample Meal Plan</h4>
          <div class="meal-card">
            <div class="meal-header">Breakfast</div>
            <div class="meal-content" id="breakfast-meal">
              <!-- Will be populated by JavaScript -->
            </div>
          </div>
          <div class="meal-card">
            <div class="meal-header">Lunch</div>
            <div class="meal-content" id="lunch-meal">
              <!-- Will be populated by JavaScript -->
            </div>
          </div>
          <div class="meal-card">
            <div class="meal-header">Dinner</div>
            <div class="meal-content" id="dinner-meal">
              <!-- Will be populated by JavaScript -->
            </div>
          </div>
          <div class="meal-card">
            <div class="meal-header">Snacks</div>
            <div class="meal-content" id="snacks-meal">
              <!-- Will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Women's Health Section -->
    <div id="womens-health" class="section womens-health" style="display: none;">
      <div class="section-title">
        <i>🌸</i> Women's Health Nutrition
      </div>
      <p>Your nutritional needs change throughout your menstrual cycle. Here are tailored recommendations:</p>
      
      <div class="cycle-phase">
        <div class="phase-title">Menstrual Phase (Days 1-5)</div>
        <p>Focus on iron-rich foods to replenish what's lost during menstruation. Include vitamin C to enhance iron absorption.</p>
      </div>
      
      <div class="cycle-phase">
        <div class="phase-title">Follicular Phase (Days 6-14)</div>
        <p>Your body is more insulin sensitive. This is a great time for higher carb intake to support energy needs.</p>
      </div>
      
      <div class="cycle-phase">
        <div class="phase-title">Ovulation Phase (Days 15-17)</div>
        <p>Energy demands are highest. Increase calorie intake slightly with nutrient-dense foods.</p>
      </div>
      
      <div class="cycle-phase">
        <div class="phase-title">Luteal Phase (Days 18-28)</div>
        <p>Progesterone rises, increasing cravings. Focus on complex carbs, healthy fats, and magnesium-rich foods.</p>
      </div>
      
      <div class="nutrient-tips">
        <div class="nutrient-tip">
          <h4>Iron</h4>
          <p>Consume with vitamin C for better absorption. Found in red meat, spinach, and lentils.</p>
        </div>
        <div class="nutrient-tip">
          <h4>Magnesium</h4>
          <p>Helps with PMS symptoms. Found in almonds, dark chocolate, and avocados.</p>
        </div>
        <div class="nutrient-tip">
          <h4>Omega-3s</h4>
          <p>Reduces inflammation. Found in fatty fish, flaxseeds, and walnuts.</p>
        </div>
      </div>
    </div>

    <!-- Supplement Guide Section -->
    <div class="section">
      <div class="section-title">
        <i>💊</i> Supplement Recommendations
      </div>
      <p>Based on your goals and metrics, these supplements may help optimize your results:</p>
      <ul style="margin-top: 1rem; padding-left: 1.5rem;">
        <li style="margin-bottom: 0.5rem;"><strong>Whey Protein</strong> - Helps meet daily protein requirements</li>
        <li style="margin-bottom: 0.5rem;"><strong>Creatine</strong> - Supports strength and muscle gains</li>
        <li style="margin-bottom: 0.5rem;"><strong>Multivitamin</strong> - Ensures micronutrient needs are met</li>
        <li style="margin-bottom: 0.5rem;"><strong>Vitamin D</strong> - Important for bone health and immunity</li>
      </ul>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
     
      // Hamburger menu toggle for mobile
      const menuToggle = document.querySelector(".menu-toggle");
      const navLinks = document.querySelector(".nav-links");
      if (menuToggle && navLinks) {
        menuToggle.addEventListener("click", function() {
          navLinks.style.display = navLinks.style.display === "flex" ? "none" : "flex";
        });
      }
      
      // Goal selection
      const goalCards = document.querySelectorAll(".goal-card");
      goalCards.forEach(card => {
        card.addEventListener("click", function() {
          goalCards.forEach(c => c.classList.remove("active"));
          this.classList.add("active");
        });
      });

      // Gender change detection
      const genderSelect = document.getElementById("gender");
      const womensHealthSection = document.getElementById("womens-health");
      
      genderSelect.addEventListener("change", function() {
        if (this.value === "female") {
          womensHealthSection.style.display = "block";
        } else {
          womensHealthSection.style.display = "none";
        }
      });

      // Budget filter selection
      const budgetBtns = document.querySelectorAll(".budget-btn");
      budgetBtns.forEach(btn => {
        btn.addEventListener("click", function(e) {
          e.preventDefault();
          budgetBtns.forEach(b => b.classList.remove("active"));
          this.classList.add("active");
          updateMealPlan(this.dataset.budget);
        });
      });

      // Meal plans by budget
      const mealPlans = {
        low: {
          breakfast: [
            { name: "Oatmeal with banana", calories: 300, price: "$" },
            { name: "Boiled eggs (2)", calories: 140, price: "$" },
            { name: "Whole wheat toast with peanut butter", calories: 200, price: "$" }
          ],
          lunch: [
            { name: "Brown rice with lentils", calories: 350, price: "$" },
            { name: "Grilled chicken breast", calories: 200, price: "$" },
            { name: "Steamed vegetables", calories: 100, price: "$" }
          ],
          dinner: [
            { name: "Baked sweet potato", calories: 180, price: "$" },
            { name: "Grilled salmon", calories: 250, price: "$$" },
            { name: "Mixed greens salad", calories: 80, price: "$" }
          ],
          snacks: [
            { name: "Greek yogurt with honey", calories: 150, price: "$" },
            { name: "Handful of almonds", calories: 160, price: "$" }
          ]
        },
        medium: {
          breakfast: [
            { name: "Greek yogurt with granola and berries", calories: 350, price: "$$" },
            { name: "Scrambled eggs with spinach", calories: 250, price: "$$" },
            { name: "Whole grain toast with avocado", calories: 300, price: "$$" }
          ],
          lunch: [
            { name: "Quinoa salad with chickpeas", calories: 400, price: "$$" },
            { name: "Grilled turkey breast", calories: 250, price: "$$" },
            { name: "Roasted vegetables", calories: 150, price: "$$" }
          ],
          dinner: [
            { name: "Grilled salmon with asparagus", calories: 400, price: "$$" },
            { name: "Brown rice pilaf", calories: 200, price: "$$" },
            { name: "Steamed broccoli", calories: 100, price: "$" }
          ],
          snacks: [
            { name: "Protein shake", calories: 200, price: "$$" },
            { name: "Hummus with carrot sticks", calories: 180, price: "$$" }
          ]
        },
        high: {
          breakfast: [
            { name: "Smoked salmon and avocado toast", calories: 450, price: "$$$" },
            { name: "Protein pancakes with maple syrup", calories: 500, price: "$$$" },
            { name: "Chia pudding with mixed berries", calories: 350, price: "$$$" }
          ],
          lunch: [
            { name: "Grilled steak with quinoa", calories: 600, price: "$$$" },
            { name: "Arugula salad with goat cheese", calories: 300, price: "$$$" },
            { name: "Roasted sweet potatoes", calories: 200, price: "$$" }
          ],
          dinner: [
            { name: "Filet mignon with mashed cauliflower", calories: 550, price: "$$$" },
            { name: "Grilled shrimp skewers", calories: 300, price: "$$$" },
            { name: "Sautéed mushrooms", calories: 150, price: "$$" }
          ],
          snacks: [
            { name: "Almond butter with apple slices", calories: 250, price: "$$" },
            { name: "Protein bar", calories: 200, price: "$$" }
          ]
        }
      };

      // Function to update meal plan based on budget
      function updateMealPlan(budget) {
        const plan = mealPlans[budget];
        
        // Update breakfast
        const breakfastEl = document.getElementById("breakfast-meal");
        breakfastEl.innerHTML = '';
        plan.breakfast.forEach(item => {
          const priceClass = item.price.length === 1 ? 'price-low' : 
                           item.price.length === 2 ? 'price-medium' : 'price-high';
          breakfastEl.innerHTML += `
            <div class="food-item">
              <span>${item.name} <span class="price-indicator ${priceClass}">${item.price}</span></span>
              <span>${item.calories} kcal</span>
            </div>
          `;
        });
        
        // Update lunch
        const lunchEl = document.getElementById("lunch-meal");
        lunchEl.innerHTML = '';
        plan.lunch.forEach(item => {
          const priceClass = item.price.length === 1 ? 'price-low' : 
                           item.price.length === 2 ? 'price-medium' : 'price-high';
          lunchEl.innerHTML += `
            <div class="food-item">
              <span>${item.name} <span class="price-indicator ${priceClass}">${item.price}</span></span>
              <span>${item.calories} kcal</span>
            </div>
          `;
        });
        
        // Update dinner
        const dinnerEl = document.getElementById("dinner-meal");
        dinnerEl.innerHTML = '';
        plan.dinner.forEach(item => {
          const priceClass = item.price.length === 1 ? 'price-low' : 
                           item.price.length === 2 ? 'price-medium' : 'price-high';
          dinnerEl.innerHTML += `
            <div class="food-item">
              <span>${item.name} <span class="price-indicator ${priceClass}">${item.price}</span></span>
              <span>${item.calories} kcal</span>
            </div>
          `;
        });
        
        // Update snacks
        const snacksEl = document.getElementById("snacks-meal");
        snacksEl.innerHTML = '';
        plan.snacks.forEach(item => {
          const priceClass = item.price.length === 1 ? 'price-low' : 
                           item.price.length === 2 ? 'price-medium' : 'price-high';
          snacksEl.innerHTML += `
            <div class="food-item">
              <span>${item.name} <span class="price-indicator ${priceClass}">${item.price}</span></span>
              <span>${item.calories} kcal</span>
            </div>
          `;
        });
      }

      // Diet calculator form
      const dietForm = document.getElementById("diet-calculator");
      const resultsSection = document.getElementById("results");
      
      dietForm.addEventListener("submit", function(e) {
        e.preventDefault();
        
        // Get form values
        const gender = document.getElementById("gender").value;
        const age = parseInt(document.getElementById("age").value);
        const height = parseInt(document.getElementById("height").value);
        const weight = parseInt(document.getElementById("weight").value);
        const activity = parseFloat(document.getElementById("activity").value);
        const goalIntensity = parseFloat(document.getElementById("goal-intensity").value);
        const selectedGoal = document.querySelector(".goal-card.active").dataset.goal;
        
        // Calculate BMI
        const heightInMeters = height / 100;
        const bmi = weight / (heightInMeters * heightInMeters);
        document.getElementById("bmi").textContent = bmi.toFixed(1);
        
        // Set BMI category
        const bmiCategory = document.getElementById("bmi-category");
        if (bmi < 18.5) {
          bmiCategory.textContent = "Underweight";
        } else if (bmi >= 18.5 && bmi < 25) {
          bmiCategory.textContent = "Normal weight";
        } else if (bmi >= 25 && bmi < 30) {
          bmiCategory.textContent = "Overweight";
        } else {
          bmiCategory.textContent = "Obese";
        }
        
        // Calculate BMR (Basal Metabolic Rate)
        let bmr;
        if (gender === "male") {
          bmr = 10 * weight + 6.25 * height - 5 * age + 5;
        } else {
          bmr = 10 * weight + 6.25 * height - 5 * age - 161;
        }
        
        // Calculate TDEE (Total Daily Energy Expenditure)
        const tdee = bmr * activity;
        
        // Adjust calories based on goal
        let calories;
        if (selectedGoal === "weight-loss") {
          calories = tdee * goalIntensity;
        } else if (selectedGoal === "muscle-gain") {
          calories = tdee * 1.1; // 10% surplus for muscle gain
        } else {
          calories = tdee; // maintenance
        }
        
        // Calculate macros
        const protein = (selectedGoal === "muscle-gain" ? 2.2 : 1.8) * weight;
        const fats = (0.25 * calories) / 9; // 25% of calories from fat
        const carbs = (calories - (protein * 4) - (fats * 9)) / 4;
        
        // Update results
        document.getElementById("calories").textContent = Math.round(calories);
        document.getElementById("protein").textContent = Math.round(protein);
        document.getElementById("carbs").textContent = Math.round(carbs);
        document.getElementById("fats").textContent = Math.round(fats);
        
        // Show results and update meal plan
        resultsSection.style.display = "block";
        updateMealPlan("low"); // Default to low budget
        
        // Scroll to results
        resultsSection.scrollIntoView({ behavior: "smooth" });
      });
       

      // Logout function
      window.logout = function() {
        localStorage.removeItem("token");
        window.location.href = "/frontend/public/login.html";
      };
    });
  
  document.addEventListener("DOMContentLoaded", () => {
    const token = localStorage.getItem("token");

    const userNav = document.getElementById("user-profile-nav");

    if (!token) {
      // Hide nav item if not logged in
      if (userNav) userNav.style.display = "none";
      return;
    }

    fetch('http://localhost:5000/api/users/profile', {
      method: 'GET',
      headers: {
        'Content-Type': "application/json",
        'Authorization': `Bearer ${token}`
      }
    })
      .then(async (res) => {
        if (!res.ok) {
          const errText = await res.text();
          throw new Error(`Server responded with ${res.status}: ${errText}`);
        }
        return res.json();
      })
      .then(user => {
        const profilePicUrl = user.profileImage
          ? `http://localhost:5000${user.profileImage}`
          : `http://localhost:5000/uploads/profile-pics/default.png`;

        const userIconImage = document.getElementById("profile-icon-img");
        if (userIconImage) {
          userIconImage.src = profilePicUrl;
        }

        // ✅ Show user profile nav
        if (userNav) userNav.style.display = "block";
      })
      .catch(error => {
        console.error("Failed to load profile pic:", error.message);
        if (userNav) userNav.style.display = "none";
      });
  });
  document.addEventListener("DOMContentLoaded", () => {
  const token = localStorage.getItem("token");

  const userNav = document.getElementById("user-profile-nav");
  const loginNav = document.getElementById("login-signup-nav");

  // Default states
  if (userNav) userNav.style.display = "none";
  if (loginNav) loginNav.style.display = "none";

  if (!token) {
    // 🔐 Not logged in: show login/signup
    if (loginNav) loginNav.style.display = "block";
    return;
  }

  // ✅ Try to fetch user profile if token exists
  fetch('http://localhost:5000/api/users/profile', {
    method: 'GET',
    headers: {
      'Content-Type': "application/json",
      'Authorization': `Bearer ${token}`
    }
  })
    .then(async (res) => {
      if (!res.ok) {
        const errText = await res.text();
        throw new Error(`Server responded with ${res.status}: ${errText}`);
      }
      return res.json();
    })
    .then(user => {
      const profilePicUrl = user.profileImage
        ? `http://localhost:5000${user.profileImage}`
        : `http://localhost:5000/uploads/profile-pics/default.png`;

      const userIconImage = document.getElementById("profile-icon-img");
      if (userIconImage) userIconImage.src = profilePicUrl;

      // 👤 Show profile dropdown, hide login
      if (userNav) userNav.style.display = "block";
      if (loginNav) loginNav.style.display = "none";
    })
    .catch(error => {
      console.error("Error fetching user:", error.message);
      // 🔐 Failed to authenticate, show login
      if (loginNav) loginNav.style.display = "block";
    });
});
// Fallback for touch devices
document.addEventListener('DOMContentLoaded', function() {
  const settingsOptions = document.querySelectorAll('.settings-option');
  
  settingsOptions.forEach(option => {
    // For mouse users
    option.addEventListener('mouseenter', function() {
      this.querySelector('.settings-submenu').style.display = 'block';
    });
    
    option.addEventListener('mouseleave', function() {
      this.querySelector('.settings-submenu').style.display = 'none';
    });
    
    // For touch devices
    option.addEventListener('click', function(e) {
      if (window.innerWidth <= 768) { // Mobile devices
        e.preventDefault();
        const submenu = this.querySelector('.settings-submenu');
        submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';
      }
    });
  });
});

  </script>
</body>
</html>